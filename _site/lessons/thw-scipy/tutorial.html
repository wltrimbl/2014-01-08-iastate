<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<link href="../../css/bootstrap/bootstrap.css" rel="stylesheet" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="../../css/bootstrap/bootstrap-responsive.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="../../css/swc.css" />
<link rel="stylesheet" type="text/css" href="../../css/swc-bootstrap.css" />
<link rel="alternate" type="application/rss+xml" title="The Software Carpentry Blog" href="/feed.xml"/>
<meta http-equiv="last-modified" content="" />
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

  </head>
  <body>
    <div class="container">
      <div class="banner">
  <a href="http://software-carpentry.org" title="Software Carpentry">
    <img alt="Software Carpentry banner" src="../../img/software-carpentry-banner.png" />
  </a>
</div>


      <div class="row-fluid">
        <div class="span10 offset1">
          <h1>Using Scipy</h1>
          <p><strong>Based on Lecture Materials By Anthony Scopatz</strong></p>

<p>Scientific Python (SciPy) is a very robust package. It encompasses
several modules ranging from the eternally practical to the quirky and
cool. No matter what your discipline is, you can probably find a
pre-made short cut using SciPy. With its considerable scope, there is no
way we can cover all of its functionality in a single tutorial. That is
what documentation is for http://docs.scipy.org/doc/! However, we can talk about
the basics, show off some of its neater features, and generally teach the
&#39;SciPy-way of doing things.&#39;</p>

<p>The presentation on SciPy will follow five sections:</p>

<ol>
<li> SciPy Constants,</li>
<li> Special Functions,</li>
<li> Integration &amp; ODEs,</li>
<li> Pade Approximates,</li>
<li> and Image Tricks.</li>
</ol>

<p>In general, you can grab SciPy functionality via</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">import</span> <span class="nn">scipy</span> 
</code></pre></div>
<p>What you get is (from
<a href="http://docs.scipy.org/doc/scipy/reference/">http://docs.scipy.org/doc/scipy/reference/</a>):</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">--</span> <span class="n">Clustering</span> <span class="n">package</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">cluster</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Constants</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Fourier</span> <span class="n">transforms</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">fftpack</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Integration</span> <span class="ow">and</span> <span class="n">ODEs</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Interpolation</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Input</span> <span class="ow">and</span> <span class="n">output</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Linear</span> <span class="n">algebra</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Maximum</span> <span class="n">entropy</span> <span class="n">models</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">maxentropy</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Miscellaneous</span> <span class="n">routines</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Multi</span><span class="o">-</span><span class="n">dimensional</span> <span class="n">image</span> <span class="n">processing</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Orthogonal</span> <span class="n">distance</span> <span class="n">regression</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">odr</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Optimization</span> <span class="ow">and</span> <span class="n">root</span> <span class="n">finding</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Signal</span> <span class="n">processing</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Sparse</span> <span class="n">matrices</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Sparse</span> <span class="n">linear</span> <span class="n">algebra</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">linalg</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Spatial</span> <span class="n">algorithms</span> <span class="ow">and</span> <span class="n">data</span> <span class="n">structures</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Special</span> <span class="n">functions</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Statistical</span> <span class="n">functions</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">Image</span> <span class="n">Array</span> <span class="n">Manipulation</span> <span class="ow">and</span> <span class="n">Convolution</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">stsci</span><span class="o">**</span><span class="p">)</span>
  <span class="o">--</span> <span class="n">C</span><span class="o">/</span><span class="n">C</span><span class="o">++</span> <span class="n">integration</span> <span class="p">(</span><span class="o">**</span><span class="n">scipy</span><span class="o">.</span><span class="n">weave</span><span class="o">**</span><span class="p">)</span>
</code></pre></div>
<h1>SciPy Constants, crawl before you walk!</h1>

<p>A plethora of important, fundamental constants can be found in
<strong>scipy.constants</strong>. NOTE: However, this module is not automatically
included when you <strong>import scipy</strong>. Still, some very basic pieces of
information are given as module attributes.</p>

<p>The following, for example:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">import</span> <span class="nn">scipy.constants</span> 
  <span class="kn">import</span> <span class="nn">math</span>

  <span class="k">print</span><span class="p">(</span><span class="s">&quot;SciPy thinks that pi = </span><span class="si">%.16f</span><span class="s">&quot;</span><span class="o">%</span><span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> 
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;While math thinks that pi = </span><span class="si">%.16f</span><span class="s">&quot;</span><span class="o">%</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> 
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;SciPy also thinks that the speed of light is c = </span><span class="si">%.1F</span><span class="s">&quot;</span><span class="o">%</span><span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">c</span><span class="p">)</span> 
</code></pre></div>
<p>will return</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">SciPy</span> <span class="n">thinks</span> <span class="n">that</span> <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.1415926535897931</span> 
  <span class="o">&gt;&gt;&gt;</span> <span class="n">While</span> <span class="n">math</span> <span class="n">thinks</span> <span class="n">that</span> <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.1415926535897931</span> 
  <span class="o">&gt;&gt;&gt;</span> <span class="n">SciPy</span> <span class="n">also</span> <span class="n">thinks</span> <span class="n">that</span> <span class="n">the</span> <span class="n">speed</span> <span class="n">of</span> <span class="n">light</span> <span class="ow">is</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">299792458.0</span> 
</code></pre></div>
<p>However, the real value of SciPy Constants is its enormous physical
constant database. These are of the form:
<strong>scipy.constants.physical_constants[name] = (value, units,
uncertainty)</strong>.</p>

<p>For example, the mass of an alpha particle is:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s">&quot;alpha particle mass&quot;</span><span class="p">]</span> 
  <span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mf">6.6446564999999997e-27</span><span class="p">,</span> <span class="s">&#39;kg&#39;</span><span class="p">,</span> <span class="mf">1.1e-33</span><span class="p">)</span> 
</code></pre></div>
<p>How can you tell what the key is for this function? My favorite way is
with the scipy.constants.find() method.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;light&quot;</span><span class="p">)</span>
</code></pre></div>
<p>gives :</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="p">[</span><span class="s">&#39;speed of light in vacuum&#39;</span><span class="p">]</span>
</code></pre></div>
<p>But buyer beware! Let&#39;s look at the speed of light again.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;c = </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="nb">str</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s">&quot;speed of light in vacuum&quot;</span><span class="p">]))</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mf">299792458.0</span><span class="p">,</span> <span class="s">&#39;m s^-1&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</code></pre></div>
<p>The uncertainty in c should not be zero! Right? Wrong. The
<a href="http://en.wikipedia.org/wiki/Metre">meter</a> is in fact set by the speed of light
in a vacuum. So there is, by definition, no error. However, this has not always
been the case.  Moreover, any actual determination of the <strong>c</strong> or the meter has
a measurement uncertainty, but SciPy does not acknowledge it.</p>

<p><strong>BASIC LESSON:</strong> As always, pay attention.</p>

<p>Check http://docs.scipy.org/doc/scipy/reference/constants.html for a complete
constants listing.</p>

<p>The above code is reproduced concisely in the constants.py file found in
the SciPy directory of your PyTrieste repository.</p>

<h1>SciPy Special Functions, walk before you run!</h1>

<p>Code that numerically approximates common (and some not-so-common)
special functions can be found in <strong>scipy.special</strong>. Here you can find
things like error functions, gamma functions, Legendre polynomials, etc.
But as a example let&#39;s focus on my favorites: the Bessel functions.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="o">*</span> 
  <span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

  <span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> 
    <span class="n">j</span> <span class="o">=</span> <span class="n">jn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
    <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span> 
    <span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">j</span><span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="s">r&#39;$J_</span><span class="si">%r</span><span class="s">$&#39;</span><span class="o">%</span><span class="n">n</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> 
    <span class="n">y</span> <span class="o">=</span> <span class="n">yn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;k--&#39;</span><span class="p">)</span> 
    <span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">6</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">],</span> <span class="s">r&#39;$Y_</span><span class="si">%r</span><span class="s">$&#39;</span><span class="o">%</span><span class="n">n</span><span class="p">)</span>

  <span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">])</span> 
  <span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$x$&#39;</span><span class="p">)</span> 
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Bessel Functions&quot;</span><span class="p">)</span>

  <span class="n">show</span><span class="p">()</span> 
</code></pre></div>
<p>These 20-ish lines of code should produce :</p>

<p><img src="/images/BesselFigure.png" alt=""></p>

<p>Note that the figure that was created here is a reproduction of Figure
6.5.1 in &#39;&#39;Numerical Recipes&#39;&#39; by W. H. Press, et al...
(http://www.nr.com/).</p>

<p>Check out http://docs.scipy.org/doc/scipy/reference/special.html for a complete
listing of special functions.</p>

<p>The above code is reproduced concisely in special_functions.py which
can be found in the SciPy directory of your PyTrieste repository.</p>

<h1>SciPy Integration, run before you glide!</h1>

<p>Tools used to calculate numerical, definite integrals may be found in
the <strong>integrate</strong> module. There are two basic ways you can integrate in
SciPy:</p>

<ol>
<li> Integrate a function,</li>
<li> Integrate piecewise data.</li>
</ol>

<p>First, let&#39;s deal with integration of functions. Recall that in Python,
functions are also objects. Therefore you can pass functions as
arguments to other functions! Just make sure that the function that you
want to integrate returns a float, or at the very least, an object that
has a <strong><strong>float</strong>()</strong> method.</p>

<h2>Integration Example: 1D</h2>

<p>The simplest way to compute a functions definite integral is via the
<strong>quad(...)</strong> function. The script</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="c">#For kicks, let&#39;s also grab</span>
  <span class="kn">import</span> <span class="nn">scipy.special</span>
  <span class="kn">import</span> <span class="nn">numpy</span>
  <span class="k">def</span> <span class="nf">CrazyFunc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">i1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>

  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Try integrating CrazyFunc on the range [-5, 10]...&quot;</span><span class="p">)</span>

  <span class="n">val</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">CrazyFunc</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

  <span class="k">print</span><span class="p">(</span><span class="s">&quot;A Crazy Function integrates to </span><span class="si">%.8E</span><span class="s">&quot;</span><span class="o">%</span><span class="n">val</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;And with insanely low error of </span><span class="si">%.8E</span><span class="s">&quot;</span><span class="o">%</span><span class="n">err</span><span class="p">)</span>
</code></pre></div>
<p>will return</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">Try</span> <span class="n">integrating</span> <span class="n">CrazyFunc</span> <span class="n">on</span> <span class="n">the</span> <span class="nb">range</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span><span class="o">...</span>  
  <span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="n">Crazy</span> <span class="n">Function</span> <span class="n">integrates</span> <span class="n">to</span> <span class="mf">6.65625226E+09</span> 
  <span class="o">&gt;&gt;&gt;</span> <span class="n">And</span> <span class="k">with</span> <span class="n">insanely</span> <span class="n">low</span> <span class="n">error</span> <span class="n">of</span> <span class="mf">3.21172897E-03</span>
</code></pre></div>
<h2>Integration Example: Infinite Limits</h2>

<p>You can also use <strong>scipy.integrate.Inf</strong> for infinity in the limits of
integration. For example, try integrating e^x on <code>[-inf, 0]</code>:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;(val, err) = &quot;</span> <span class="o">+</span> 
      <span class="nb">str</span><span class="p">(</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="o">-</span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">Inf</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="p">))</span>
</code></pre></div>
<p>will return :</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0000000000000002</span><span class="p">,</span> <span class="mf">5.8426067429060041e-11</span><span class="p">)</span>
</code></pre></div>
<h2>Integration Example: 2D</h2>

<p>Two dimensional integrations follow similarly to the 1D case. However,
now we need to use the <strong>dblquad( f(y,x), ...)</strong> function instead of
simply <strong>quad( f(x), ...)</strong>. Because a picture is worth 10^3 words,
SciPy computes the right-hand side of the following equation:</p>

<p><img src="/images/dblquad.png" alt=""></p>

<p>More information on the justification of this integral may be found at
http://en.wikipedia.org/wiki/Order_of_integration_(calculus). For
example, let&#39;s try to integrate the surface area of a unit sphere:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="k">def</span> <span class="nf">dA_Sphere</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span>  <span class="n">scipy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Integrate the surface area of the unit sphere...&quot;</span><span class="p">)</span>
  <span class="n">val</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">dA_Sphere</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> 
    <span class="k">lambda</span> <span class="n">theta</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> 
    <span class="k">lambda</span> <span class="n">theta</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">pi</span> <span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;val = </span><span class="si">%.8F</span><span class="s">&quot;</span><span class="o">%</span><span class="n">val</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;err = </span><span class="si">%.8E</span><span class="s">&quot;</span><span class="o">%</span><span class="n">err</span><span class="p">)</span>
</code></pre></div>
<p>This will return :</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">Integrate</span> <span class="n">the</span> <span class="n">surface</span> <span class="n">area</span> <span class="n">of</span> <span class="n">the</span> <span class="n">unit</span> <span class="n">sphere</span><span class="o">...</span>  
  <span class="o">&gt;&gt;&gt;</span> <span class="n">val</span> <span class="o">=</span> <span class="mf">12.56637061</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">err</span> <span class="o">=</span> <span class="mf">1.39514740E-13</span>
</code></pre></div>
<p>There are a couple of subtleties here. First is that the function you
are integrating over is defined as <strong>f(y,x)</strong> and NOT the more standard
<strong>f(x,y)</strong>. Moreover, while <strong>x</strong>&#39;s limits of integration are given
directly <strong>[0, 2*pi]</strong>,<strong>y</strong>&#39;s limits have to be functions<strong>[g(x),
h(x)]<em>\</em> (given by the &#39;lambdas&#39; here). This method of doing double
integrals allows for</strong>y<em>\</em> to have a more complicated edge in*<em>x</em>* than
a simple point. This is great for some functions but a little annoying
for simple integrations. In any event, the above integral computes the
surface are of a unit sphere to be *<em>4</em>pi<em>\</em> to within floating point
error.</p>

<h2>Integration Example: 3D</h2>

<p>Three dimensional integration is more similar to 2D than 1D. Once again,
we define our function variables in reverse order, <strong>f(z, y, x)</strong>, and
integrate using <strong>tplquad( f(z, y, x) )</strong>. Moreover, <strong>z</strong> has limits of
integration defined by surfaces give as functions <strong>[q(x,y), r(x,y)]</strong>.
Thus, <strong>tplquad(...)</strong> integrates the right-hand side of :</p>

<p><img src="/images/trplquad.png" alt=""></p>

<p>To continue with the previous example, let&#39;s try integrating the volume
of a sphere. Take the radius here to be 3.5.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="k">def</span> <span class="nf">dV_Sphere</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">dA_Sphere</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Integrate the volume of a sphere with r=3.5...&quot;</span><span class="p">)</span>
  <span class="n">val</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">tplquad</span><span class="p">(</span><span class="n">dV_Sphere</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;val = </span><span class="si">%.8F</span><span class="s">&quot;</span><span class="o">%</span><span class="n">val</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;err = </span><span class="si">%.8E</span><span class="s">&quot;</span><span class="o">%</span><span class="n">err</span><span class="p">)</span>
</code></pre></div>
<p>will return:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">Integrate</span> <span class="n">the</span> <span class="n">volume</span> <span class="n">of</span> <span class="n">a</span> <span class="n">sphere</span> <span class="k">with</span> <span class="n">r</span><span class="o">=</span><span class="mf">3.5</span><span class="o">...</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">val</span> <span class="o">=</span> <span class="mf">179.59438003</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">err</span> <span class="o">=</span> <span class="mf">1.99389816E-12</span>
</code></pre></div>
<p>A simple hand calculation verifies this result.</p>

<h2>Integration Example: Trapazoidal</h2>

<p>Now, only very rarely will scientists (and even more rarely engineers)
will truely &#39;know&#39; the function that they wish to integrate. Much more
often we&#39;ll have piecewise data that we wish numerically integrate (ie
sum an array y(x), biased by array x). This can be done in SciPy through
the <strong>trapz(...)</strong> function.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">y</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Trapazoidally integrate y = x on [0,10]...&quot;</span><span class="p">)</span>
  <span class="n">val</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;val = </span><span class="si">%F</span><span class="s">&quot;</span><span class="o">%</span><span class="n">val</span><span class="p">)</span>
</code></pre></div>
<p>will return:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">Trapazoidally</span> <span class="n">integrate</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="n">on</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span><span class="o">...</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">val</span> <span class="o">=</span> <span class="mf">50.000000</span>
</code></pre></div>
<p>The above takes a series of y-values that are implicitly spaced 1-unit
apart in x and &#39;trapazoidally integrates&#39; them. Basically, just a sum.</p>

<p>However, you can use the <strong>x= [0, 3,...]</strong> or <strong>dx = 3</strong> argument
keywords to explicitly declare different spacings in x. For example,
with y = x^2:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">20.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Trapazoidally integrate y = x^2 on [0,20] with half steps...&quot;</span><span class="p">)</span>
  <span class="n">val</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;val = </span><span class="si">%F</span><span class="s">&quot;</span><span class="o">%</span><span class="n">val</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">Trapazoidally</span> <span class="n">integrate</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="n">on</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="k">with</span> <span class="n">half</span> <span class="n">steps</span><span class="o">...</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">val</span> <span class="o">=</span> <span class="mf">2667.500000</span>
</code></pre></div><div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Trapazoidally integrate y = x^2 with dx = 0.5...&quot;</span><span class="p">)</span>
  <span class="n">val</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;val = </span><span class="si">%F</span><span class="s">&quot;</span><span class="o">%</span><span class="n">val</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">Trapazoidally</span> <span class="n">integrate</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="k">with</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">...</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">val</span> <span class="o">=</span> <span class="mf">2667.500000</span>
</code></pre></div>
<h2>Integration Example: Ordinary Differential Equations</h2>

<p>Say that you have an ODE of the form <strong>dy/dt = f(y, t)</strong> that you
&#39;&#39;really&#39;&#39; need integrated. Then you, my friend, are in luck! SciPy can
do this for you using the <strong>scipy.integrate.odeint</strong> function. This is
of the form:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">odeint</span><span class="p">(</span> <span class="n">f</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="p">[</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</code></pre></div>
<p>For example take the decay equation:
   (y, t) = - lambda * y </p>

<p>We can then try integrating this using a decay constant of 0.2`:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="k">def</span> <span class="nf">dDecay</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">lam</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">lam</span><span class="o">*</span><span class="n">y</span>

  <span class="n">vals</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">dDecay</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span> <span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;If you start with a mass of y(0) = </span><span class="si">%F</span><span class="s">&quot;</span><span class="o">%</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&quot;you&#39;ll only have y(t= 10) = </span><span class="si">%F</span><span class="s"> left.&quot;</span><span class="o">%</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<p>This will return</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="n">If</span> <span class="n">you</span> <span class="n">start</span> <span class="k">with</span> <span class="n">a</span> <span class="n">mass</span> <span class="n">of</span> <span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.000000</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">you</span><span class="s">&#39;ll only have y(t= 10) = 0.135335 left.</span>
</code></pre></div>
<p>Check out http://docs.scipy.org/doc/scipy/reference/integrate.html for more
information on integreation.</p>

<p>The above code is reproduced concisely in integrate.py, which can be
found in the SciPy direcotry of your PyTreiste repository.</p>

<h1>SciPy Pade, glide before you fly!</h1>

<p>As you have seen, SciPy has some really neat functionality that comes
stock. Oddly, some of the best stuff is in the <code>miscellaneous</code> module
accessed via <strong>import scipy.misc</strong>. What follows is a brief explanation of the
Pade Approximant (http://en.wikipedia.org/wiki/Pad√©_approximant) and how to
utilize it in SciPy.</p>

<p>Most people are familar with the polynomial expansions of a function:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">f(x) = a + bx + cx^2 + ...
</code></pre></div>
<p>Or a Taylor expansion:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">f(x) = sum( d^n f(a) / dx^n (x-a)^n /n! )
</code></pre></div>
<p>However, there exists the lesser known, more exact Pade approximation.
This basically splits up a function into a numerator and a denominator.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">f(x) = p(x) / q(x)
</code></pre></div>
<p>Then, you can approximate p(x) and q(x) using a power series. However to
generate p(x) and q(x) of order <code>N</code>, you first need the
polynomial approximation of f(x) to order <code>2N+1</code> (for when p and
q are expanded to the same order). Thus the Pade approximate is a way to
squeeze greater orders of accuracy out of another, more expensively
gained approximation. A more complete treatment is available in Section
5.12 in &#39;&#39;Numerical Recipes&#39;&#39; by W. H. Press, et al...
(http://www.nr.com/). The strength of this method
is demonstrated though examples and figures.</p>

<p>First let&#39;s take the case for where f(x) = e^x.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">import</span> <span class="nn">scipy.misc</span>
  <span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

  <span class="c">#Let&#39;s expand e^x to fifth order and record the coefficents </span>
  <span class="n">e_exp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">24.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">120.0</span><span class="p">]</span>

  <span class="c">#The Pade coefficients are given simply by, </span>
  <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">pade</span><span class="p">(</span><span class="n">e_exp</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
  <span class="c">#p and q are of numpy&#39;s polynomial class</span>
  <span class="c">#So the Pade approximation is given by </span>
  <span class="k">def</span> <span class="nf">PadeAppx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">q</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="c">#Let&#39;s test it...</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

  <span class="n">e_exp</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
  <span class="n">e_poly</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">(</span><span class="n">e_exp</span><span class="p">)</span>

  <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PadeAppx</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Pade Approximation&quot;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">e</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">r&#39;$e^x$&#39;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">e_poly</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Power Series&quot;</span><span class="p">)</span>

  <span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$x$&#39;</span><span class="p">)</span>
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Exponential Functions&quot;</span><span class="p">)</span>

  <span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>The above script, pade1.py, generates the following figure :</p>

<p><img src="/images/PadeFigure1.png" alt=""></p>

<p>Now the gains from using the Pade approximant for an exponential here seem
slight. This is because the original exponential expansion is rather well
defined. Still the Pade version in this case has two important advantages:</p>

<ol>
<li><p>The power series version of e^x would still require about twice as many
terms to gain that slight increase in accuracy that the Pade gives.</p></li>
<li><p>If instead x were replaced by the matrix A, then e^A could be calculated
with about half as many multiplications and sums using Pade rather than a
polynomial. Success!</p></li>
</ol>

<p>However, Pade&#39;s real power can be seen when approximating a different
function. Let&#39;s try approximating a rougher function...</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">import</span> <span class="nn">scipy.misc</span>
  <span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>

  <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
          <span class="k">return</span> <span class="p">(</span><span class="mf">7.0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>

  <span class="c">#Through someone else&#39;s labors we know the expansion to be... </span>
  <span class="n">f_exp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">81.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">49.0</span><span class="o">/</span><span class="mf">8748.0</span><span class="p">,</span> <span class="mf">175.0</span><span class="o">/</span><span class="mf">78732.0</span><span class="p">]</span>

  <span class="c">#The Pade coefficients are given simply by, </span>
  <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">pade</span><span class="p">(</span><span class="n">f_exp</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
  <span class="c">#p and q are of numpy&#39;s polynomial class</span>
  <span class="c">#So the Pade approximation is given by </span>
  <span class="k">def</span> <span class="nf">PadeAppx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
          <span class="k">return</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">q</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="c">#Let&#39;s test it...</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

  <span class="n">f_exp</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
  <span class="n">f_poly</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">(</span><span class="n">f_exp</span><span class="p">)</span>

  <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PadeAppx</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Pade Approximation&quot;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">r&#39;$f(x)$&#39;</span><span class="p">)</span>
  <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_poly</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;Power Series&quot;</span><span class="p">)</span>

  <span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;$x$&#39;</span><span class="p">)</span>
  <span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Polynomial Function&quot;</span><span class="p">)</span>

  <span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p>The above script, pade2.py, generates the following figure
<img src="/images/PadeFigure2.png" alt=""></p>

<p>Note, that this example is again taken from Section 5.12 in Numerical
Recipes by W. H. Press, et
al (http://www.nr.com/).</p>

<p>Check out http://docs.scipy.org/doc/scipy/reference/misc.html#scipy.misc.pade
for more details on SciPy&#39;s Pade interface.</p>

<h1>SciPy Image Tricks, fly before you....You can do that?!</h1>

<p>For some reason that has yet to be explained to me, SciPy has the
ability to treat 2D &amp; 3D arrays as images. You can even convert PIL
images or read in external files as numpy arrays! From here, you can
fool around with the raw image data at will. Naturally, this
functionality is buried (again) within the <code>miscellaneous</code> module.</p>

<p>First let&#39;s read in an image file. For now make it a JPEG. From
Wikipedia. Of a bunny.  http://en.wikipedia.org/wiki/File:JumpingRabbit.JPG</p>

<p><img src="/images/image.jpg" alt=""></p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">import</span> <span class="nn">scipy.misc</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s">&quot;image.jpg&quot;</span><span class="p">)</span>
  <span class="c">#Note that this really is an array!</span>
  <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
</code></pre></div><div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;&gt;&gt;</span> <span class="p">[[[</span><span class="mi">130</span> <span class="mi">174</span>  <span class="mi">27</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">129</span> <span class="mi">173</span>  <span class="mi">24</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">127</span> <span class="mi">171</span>  <span class="mi">22</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="o">...</span><span class="p">,</span> 
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">147</span> <span class="mi">192</span>  <span class="mi">41</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">146</span> <span class="mi">190</span>  <span class="mi">41</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">146</span> <span class="mi">190</span>  <span class="mi">41</span><span class="p">]]</span>
  <span class="o">&gt;&gt;&gt;</span> 
  <span class="o">&gt;&gt;&gt;</span>  <span class="p">[[</span><span class="mi">137</span> <span class="mi">177</span>  <span class="mi">29</span><span class="p">]</span>

  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">133</span> <span class="mi">175</span>  <span class="mi">27</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">130</span> <span class="mi">173</span>  <span class="mi">21</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="o">...</span><span class="p">,</span> 
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">147</span> <span class="mi">192</span>  <span class="mi">37</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">149</span> <span class="mi">194</span>  <span class="mi">41</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">149</span> <span class="mi">194</span>  <span class="mi">41</span><span class="p">]]</span>
  <span class="o">&gt;&gt;&gt;</span> 
  <span class="o">&gt;&gt;&gt;</span>  <span class="p">[[</span><span class="mi">141</span> <span class="mi">177</span>  <span class="mi">29</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">137</span> <span class="mi">176</span>  <span class="mi">25</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">130</span> <span class="mi">174</span>  <span class="mi">19</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="o">...</span><span class="p">,</span> 
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">148</span> <span class="mi">194</span>  <span class="mi">34</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">149</span> <span class="mi">195</span>  <span class="mi">35</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">149</span> <span class="mi">195</span>  <span class="mi">35</span><span class="p">]]</span>
  <span class="o">&gt;&gt;&gt;</span> 
  <span class="o">&gt;&gt;&gt;</span>  <span class="o">...</span><span class="p">,</span> 
  <span class="o">&gt;&gt;&gt;</span>  <span class="p">[[</span> <span class="mi">77</span> <span class="mi">126</span>   <span class="mi">1</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">87</span> <span class="mi">137</span>  <span class="mi">14</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">85</span> <span class="mi">139</span>   <span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="o">...</span><span class="p">,</span> 
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">77</span> <span class="mi">128</span>   <span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">99</span> <span class="mi">159</span>   <span class="mi">3</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">128</span> <span class="mi">183</span>  <span class="mi">17</span><span class="p">]]</span>

  <span class="o">&gt;&gt;&gt;</span>  <span class="p">[[</span> <span class="mi">86</span> <span class="mi">139</span>   <span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">90</span> <span class="mi">141</span>  <span class="mi">12</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">82</span> <span class="mi">136</span>   <span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="o">...</span><span class="p">,</span> 
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">66</span> <span class="mi">114</span>   <span class="mi">2</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">102</span> <span class="mi">160</span>   <span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">119</span> <span class="mi">174</span>  <span class="mi">11</span><span class="p">]]</span>
  <span class="o">&gt;&gt;&gt;</span> 
  <span class="o">&gt;&gt;&gt;</span>  <span class="p">[[</span> <span class="mi">89</span> <span class="mi">140</span>   <span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">79</span> <span class="mi">129</span>   <span class="mi">8</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">87</span> <span class="mi">139</span>   <span class="mi">2</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="o">...</span><span class="p">,</span> 
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">67</span> <span class="mi">117</span>   <span class="mi">4</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span> <span class="mi">81</span> <span class="mi">138</span>   <span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span>   <span class="p">[</span><span class="mi">117</span> <span class="mi">172</span>  <span class="mi">18</span><span class="p">]]]</span>
</code></pre></div>
<p>We can now apply some basic filters...</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imfilter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s">&#39;blur&#39;</span><span class="p">)</span>
</code></pre></div>
<p>We can even rotate the image, counter-clockwise by degrees.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imrotate</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
</code></pre></div>
<p>And then, we can rewrite the array to an image file.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imsave</span><span class="p">(</span><span class="s">&quot;image1.jpg&quot;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
</code></pre></div>
<p>These functions produce the following image:</p>

<p><img src="/images/image1.jpg" alt=""></p>

<p>Because the array takes integer values from 0 - 255, we can easily
define our own filters as well! For instance, you could write a two-line
function to inverse the image...</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="k">def</span> <span class="nf">InverseImage</span><span class="p">(</span><span class="n">imgarr</span><span class="p">):</span>
     <span class="k">return</span> <span class="mi">255</span> <span class="o">-</span> <span class="n">imgarr</span>
  <span class="c">#Starting fresh we get...</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s">&quot;image.jpg&quot;</span><span class="p">)</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imrotate</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">330</span><span class="p">)</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">InverseImage</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
  <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imsave</span><span class="p">(</span><span class="s">&quot;image2.jpg&quot;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
</code></pre></div>
<p>Having this much fun, the rabbit becomes a twisted shade of its former
self!</p>

<p><img src="/images/image2.jpg" alt=""></p>

<p>Check out http://docs.scipy.org/doc/scipy/reference/misc.html for a complete
listing of associated image functions.</p>

<p>The code above can be found in the image_tricks.py file in the SciPy
directory of your repository..</p>

	</div>
      </div>

      <div class="footer">
  <a class="label swc-blue-bg" href="https://www.facebook.com/SoftwareCarpentry">Facebook</a>
  <a class="label swc-blue-bg" href="https://plus.google.com/u/0/114244759874490019250/posts">Google+</a>
  <a class="label swc-blue-bg" href="https://twitter.com/swcarpentry">Twitter</a>
  <a class="label swc-blue-bg" href="https://github.com/swcarpentry">GitHub</a>
  <a class="label swc-blue-bg" href="http://software-carpentry.org/feed.xml">RSS</a>
  <a class="label swc-blue-bg" href="../../license.html">License</a>
  <a class="bugreport label swc-blue-bg" href="mailto:info@software-carpentry.org?subject=bug%20in%20lessons/thw-scipy/tutorial.md">Bug Report</a>
</div>

    </div>
    <!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../../js/jquery-1.9.1.min.js"></script>
<script src="../../js/bootstrap/bootstrap.min.js"></script>

  </body>
</html>
